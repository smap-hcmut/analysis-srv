apiVersion: v1
kind: ConfigMap
metadata:
  name: smap-analytics-config
  namespace: smap
  labels:
    app: smap-analytics
data:
  # Service Configuration
  SERVICE_NAME: "analytics-engine"
  SERVICE_VERSION: "0.1.0"
  LOG_LEVEL: "INFO"
  DEBUG: "false"

  # PhoBERT Model Configuration
  PHOBERT_MODEL_PATH: "infrastructure/phobert/models"
  PHOBERT_MAX_LENGTH: "128"
  PHOBERT_MODEL_FILE: "model_quantized.onnx"

  # SpaCy-YAKE Configuration
  SPACY_MODEL: "xx_ent_wiki_sm"
  YAKE_LANGUAGE: "vi"
  YAKE_N: "2"
  YAKE_DEDUP_LIM: "0.8"
  YAKE_MAX_KEYWORDS: "30"
  MAX_KEYWORDS: "30"
  ENTITY_WEIGHT: "0.7"
  CHUNK_WEIGHT: "0.5"

  # Aspect Mapping
  ENABLE_ASPECT_MAPPING: "false"
  ASPECT_DICTIONARY_PATH: "config/aspects.yaml"
  UNKNOWN_ASPECT_LABEL: "UNKNOWN"

  # Text Preprocessor
  PREPROCESSOR_MIN_TEXT_LENGTH: "10"
  PREPROCESSOR_MAX_COMMENTS: "5"

  # Intent Classifier
  INTENT_CLASSIFIER_ENABLED: "true"
  INTENT_CLASSIFIER_CONFIDENCE_THRESHOLD: "0.5"
  INTENT_PATTERNS_PATH: "config/intent_patterns.yaml"

  # Compression
  COMPRESSION_ENABLED: "true"
  COMPRESSION_DEFAULT_LEVEL: "2"
  COMPRESSION_ALGORITHM: "zstd"
  COMPRESSION_MIN_SIZE_BYTES: "1024"

  # Impact Calculator
  IMPACT_WEIGHT_VIEW: "0.01"
  IMPACT_WEIGHT_LIKE: "1.0"
  IMPACT_WEIGHT_COMMENT: "2.0"
  IMPACT_WEIGHT_SAVE: "3.0"
  IMPACT_WEIGHT_SHARE: "5.0"
  IMPACT_PLATFORM_WEIGHT_TIKTOK: "1.0"
  IMPACT_PLATFORM_WEIGHT_FACEBOOK: "1.2"
  IMPACT_PLATFORM_WEIGHT_YOUTUBE: "1.5"
  IMPACT_PLATFORM_WEIGHT_INSTAGRAM: "1.1"
  IMPACT_PLATFORM_WEIGHT_UNKNOWN: "1.0"
  IMPACT_AMP_NEGATIVE: "1.5"
  IMPACT_AMP_NEUTRAL: "1.0"
  IMPACT_AMP_POSITIVE: "1.1"
  IMPACT_VIRAL_THRESHOLD: "70.0"
  IMPACT_KOL_FOLLOWER_THRESHOLD: "50000"
  IMPACT_MAX_RAW_SCORE_CEILING: "100000.0"

  # Batch Processing
  MAX_CONCURRENT_BATCHES: "5"
  BATCH_TIMEOUT_SECONDS: "30"
  EXPECTED_BATCH_SIZE_TIKTOK: "50"
  EXPECTED_BATCH_SIZE_YOUTUBE: "20"

  # Error Handling
  MAX_RETRIES_PER_ITEM: "3"
  ERROR_BACKOFF_BASE_SECONDS: "1.0"
  ERROR_BACKOFF_MAX_SECONDS: "60.0"

  # Database Pool
  DATABASE_POOL_SIZE: "20"
  DATABASE_MAX_OVERFLOW: "10"

  # RabbitMQ
  RABBITMQ_QUEUE_NAME: "analytics_queue"
  RABBITMQ_PREFETCH_COUNT: "1"
  EVENT_EXCHANGE: "smap.events"
  EVENT_ROUTING_KEY: "data.collected"
  EVENT_QUEUE_NAME: "analytics.data.collected"

  # MinIO
  MINIO_CRAWL_RESULTS_BUCKET: "crawl-results"
